<VirtualHost *:80>
	ServerAdmin webmaster@geeksoc.org
	ServerName nagios.geeksoc.org
	ServerAlias www.nagios.geeksoc.org
	DocumentRoot /usr/share/nagios3/htdocs
ScriptAlias /nagios/cgi-bin/ /usr/<%= scope.lookupvar("nagios::params::libdir") %>/nagios/cgi-bin/
<Directory /usr/<%= scope.lookupvar("nagios::params::libdir") %>/nagios/cgi-bin/>
   Options ExecCGI
   Allow from All
   AuthType Basic
        AuthName "GeekSoc Nagios"
        AuthBasicProvider ldap
        AuthzLDAPAuthoritative on
        AuthLDAPURL ldap://ldap.geeksoc.org:389/dc=geeksoc,dc=org?uid?sub
        AuthLDAPGroupAttribute memberUid
        AuthLDAPGroupAttributeIsDN off
        Satisfy any
</Directory>

Alias /nagios/ /usr/share/nagios/html/
<Directory /usr/share/nagios/html/>
   Options FollowSymlinks
<% if !@apache_allowed_from.empty? -%>
   Order Deny,Allow
   Deny from all
   Allow from 127.0.0.1
<% @apache_allowed_from.each do |val| -%>
   Allow from <%= val %>
<% end -%>
<% end -%>
   AuthType Basic
   AuthUserFile /etc/nagios/.htpasswd
   AuthName "Nagios"
   Require valid-user
</Directory>

# For SSL-servers
#<Directory /usr/lib/nagios/cgi-bin/>
#   Options ExecCGI
#   SSLRequireSSL
#   Order Deny,Allow
#   Deny from all
#   Allow from 127.0.0.1
#   AuthType Basic
#   AuthUserFile /etc/nagios/.htpasswd
#   AuthName "nagios"
#   Require valid-user
#</Directory>
#
#Alias /nagios/ /usr/share/nagios/html/
#<Directory /usr/share/nagios/html/>
#   Options None
#   SSLRequireSSL
#   Order Deny,Allow
#   Deny from all
#   Allow from 127.0.0.1
#   AuthType Basic
#   AuthUserFile /etc/nagios/.htpasswd
#   AuthName "nagios"
#   Require valid-user
#</Directory>
</VirtualHost>
